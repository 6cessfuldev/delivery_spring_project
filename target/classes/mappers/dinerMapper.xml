<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ezen.delivery.repository.DinerDAO">

<select id="selectListAll" resultType="com.ezen.delivery.domain.DinerVO">
	select * from diner
</select>

<select id="selectListFirst" resultType="com.ezen.delivery.domain.DinerVO">
	select * from diner limit 0, 20
</select>

<select id="selectList" parameterType="com.ezen.delivery.domain.PagingVO" resultType="com.ezen.delivery.domain.DinerVO">
	select * from diner order by ST_Distance_Sphere(diner_addr_point, point(#{lng}, #{lat})) limit #{startNum}, 10 
</select>

<select id="selectListbyCate" parameterType="com.ezen.delivery.domain.PagingVO" resultType="com.ezen.delivery.domain.DinerVO">
	select * from diner where diner_category like concat('%', #{category}, '%') order by ST_Distance_Sphere(diner_addr_point, point(#{lng}, #{lat})) limit #{startNum}, 10 
</select>

<insert id="insert">
insert into diner(diner_file_code, diner_name, diner_address, diner_min_pay, diner_notice, diner_open_time, diner_close_time, diner_method_pay,
			 diner_business_name, diner_company_num, diner_category, diner_addr_point)
		value(#{diner_file_code}, #{diner_name}, #{diner_address}, #{diner_min_pay}, #{diner_notice}, #{diner_open_time}, #{diner_close_time}, 
			#{diner_method_pay}, #{diner_business_name}, #{diner_company_num}, #{diner_category}, POINT(#{diner_addr_lng}, #{diner_addr_lat}))
</insert>

<select id="selectDiner" resultType="com.ezen.delivery.domain.DinerVO">
	select * from diner where diner_code = #{diner_code}
</select>
</mapper>